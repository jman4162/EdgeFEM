// Periodic Unit Cell
// Generated by VectorEM geometry generator
// Cell: 15.00 x 15.00 mm
// Element: 7.50 x 9.75 mm

lc = 0.001875;
lc_fine = 0.0009375;

// Ground (z=0)
Point(1) = {0, 0, 0, lc};
Point(2) = {0.015, 0, 0, lc};
Point(3) = {0.015, 0.015, 0, lc};
Point(4) = {0, 0.015, 0, lc};

Line(1) = {1, 2};
Line(2) = {2, 3};
Line(3) = {3, 4};
Line(4) = {4, 1};

Curve Loop(1) = {1, 2, 3, 4};
Plane Surface(1) = {1};

// Substrate top (z=h)
Point(5) = {0, 0, 0.00157, lc};
Point(6) = {0.015, 0, 0.00157, lc};
Point(7) = {0.015, 0.015, 0.00157, lc};
Point(8) = {0, 0.015, 0.00157, lc};

// Element on substrate
Point(9) = {0.00375, 0.0026249999999999997, 0.00157, lc_fine};
Point(10) = {0.01125, 0.0026249999999999997, 0.00157, lc_fine};
Point(11) = {0.01125, 0.012375, 0.00157, lc_fine};
Point(12) = {0.00375, 0.012375, 0.00157, lc_fine};

// Air top (z=h+ha)
Point(13) = {0, 0, 0.016569999999999998, lc};
Point(14) = {0.015, 0, 0.016569999999999998, lc};
Point(15) = {0.015, 0.015, 0.016569999999999998, lc};
Point(16) = {0, 0.015, 0.016569999999999998, lc};

// Substrate top edges
Line(5) = {5, 6};
Line(6) = {6, 7};
Line(7) = {7, 8};
Line(8) = {8, 5};

// Element edges
Line(9) = {9, 10};
Line(10) = {10, 11};
Line(11) = {11, 12};
Line(12) = {12, 9};

// Substrate top surface (with element hole)
Curve Loop(2) = {5, 6, 7, 8};
Curve Loop(3) = {9, 10, 11, 12};
Plane Surface(2) = {2, 3};
Plane Surface(3) = {3};  // Element

// Air top
Line(13) = {13, 14};
Line(14) = {14, 15};
Line(15) = {15, 16};
Line(16) = {16, 13};

Curve Loop(4) = {13, 14, 15, 16};
Plane Surface(4) = {4};

// Vertical edges (substrate)
Line(17) = {1, 5};
Line(18) = {2, 6};
Line(19) = {3, 7};
Line(20) = {4, 8};

// Vertical edges (air)
Line(21) = {5, 13};
Line(22) = {6, 14};
Line(23) = {7, 15};
Line(24) = {8, 16};

// Substrate sides
Curve Loop(5) = {1, 18, -5, -17};  // y=0
Plane Surface(5) = {5};
Curve Loop(6) = {2, 19, -6, -18};  // x=cx
Plane Surface(6) = {6};
Curve Loop(7) = {3, 20, -7, -19};  // y=cy
Plane Surface(7) = {7};
Curve Loop(8) = {4, 17, -8, -20};  // x=0
Plane Surface(8) = {8};

// Air sides
Curve Loop(9) = {5, 22, -13, -21};   // y=0
Plane Surface(9) = {9};
Curve Loop(10) = {6, 23, -14, -22};  // x=cx
Plane Surface(10) = {10};
Curve Loop(11) = {7, 24, -15, -23};  // y=cy
Plane Surface(11) = {11};
Curve Loop(12) = {8, 21, -16, -24};  // x=0
Plane Surface(12) = {12};

// Volumes
Surface Loop(1) = {1, 2, 3, 5, 6, 7, 8};
Volume(1) = {1};

Surface Loop(2) = {2, 3, 4, 9, 10, 11, 12};
Volume(2) = {2};

// Physical groups
Physical Surface("Ground", 1) = {1};
Physical Surface("Element", 2) = {3};
Physical Surface("FloquetPort", 3) = {4};
Physical Surface("MasterX", 4) = {8, 12};  // x=0
Physical Surface("SlaveX", 5) = {6, 10};   // x=cx
Physical Surface("MasterY", 6) = {5, 9};   // y=0
Physical Surface("SlaveY", 7) = {7, 11};   // y=cy
Physical Volume("Substrate", 100) = {1};   // eps_r = 4.4
Physical Volume("Air", 101) = {2};

// Mesh settings
Mesh.Algorithm3D = 4;
Mesh.Optimize = 1;
